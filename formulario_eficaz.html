<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <title>Ficha de Cadastro - Eficaz Facility</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
      color: #333;
    }

header {
  background-color: #3c4a6e;
  padding: 20px;
  color: white;
  text-align: center;
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}

h2 {
  margin: 0;
  font-size: 24px;
}

    main {
      max-width: 960px;
      margin: 40px auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    fieldset {
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 25px;
      border-radius: 6px;
    }

    legend {
      font-weight: bold;
      color: #2c3e50;
    }

    label {
      display: block;
      margin-top: 15px;
    }

    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    button {
      background-color: #0073e6;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 15px;
    }

    button:hover {
      background-color: #005bb5;
    }

    #mensagem {
      display: none;
      color: green;
      font-weight: bold;
      margin-top: 20px;
    }

    .dependente-campo {
      display: none;
    }

    .botoes-final {
      text-align: right;
      margin-top: 20px;
    }

   @media print {
  body {
    background-color: white;
    font-size: 8.5px;
    margin: 0;
    padding: 0;
    color: black;
  }

  header {
    background-color: white;
    color: black;
    text-align: center;
    padding: 4px;
  }

  header h2 {
    font-size: 14px;
    margin: 5px 0;
  }

  main {
    box-shadow: none;
    max-width: 100%;
    padding: 8px;
    margin: 0;
    column-count: 2;
    column-gap: 14px;
  }

  fieldset {
    page-break-inside: avoid;
    break-inside: avoid;
    border: 1px solid #000;
    padding: 6px;
    margin: 4px 0;
  }

  legend {
    font-size: 9px;
    font-weight: bold;
    margin-bottom: 4px;
  }

  label {
    margin: 2px 0 1px 0;
    font-size: 8px;
  }

  input, select, textarea {
    border: none;
    border-bottom: 1px solid #000;
    padding: 1px 3px;
    background: none;
    font-size: 8px;
  }

  .botoes-final,
  #mensagem {
    display: none !important;
  }

  #botao-imprimir {
    display: block !important;
  }
}

  </style>
</head>
<body>
  <header>
    <h2>Ficha de Cadastro - Eficaz Facility</h2>
  </header>
  <main>
    <form action="https://script.google.com/macros/s/AKfycbyuvoQ6_n7kAL_QhGTkWCTbPM2s6p7fhfcC6VaJ29c4hFNm1ZIZmxNNhym2imblwHCJiA/exec" method="post">
       <fieldset>
            <legend>Empresa</legend>
            <label for="empresa">Empresa</label>
            <input id="empresa" name="empresa" type="text" value="Eficaz Facility"/>
            <label for="cnpj">CNPJ</label>
            <input id="cnpj" name="cnpj" type="text" value="37.129.474/0001-48"/>
        </fieldset>
        <fieldset>
            <legend>Colaborador</legend>
            <label for="nome">Nome</label>
            <input id="nome" name="nome" type="text"/>
            <label for="admissao">Data de Admissão</label>
            <input id="admissao" name="admissao" type="date"/>
            <label for="salario">Salário</label>
            <input id="salario" name="salario" step="0.01" type="number"/>
            <label for="experiencia">Experiência</label>
            <input id="experiencia" name="experiencia" type="text"/>
            <label for="cc">C.C.</label><input id="cc" name="cc" type="text"/><label for="funcao">Função</label><input id="funcao" name="funcao" type="text"/><label for="adicional">Adicional</label><input id="adicional" name="adicional" type="text"/><label for="horario">Horário</label><input id="horario" name="horario" type="text"/></fieldset>
        <fieldset>
            <legend>Dados Pessoais</legend>
            <label for="nome_mae">Nome da Mãe</label>
            <input id="nome_mae" name="nome_mae" type="text"/>
            <label for="nome_pai">Nome do Pai</label>
            <input id="nome_pai" name="nome_pai" type="text"/>
            <label for="nascimento">Data de Nascimento</label>
            <input id="nascimento" name="nascimento" type="date"/>
            <label for="naturalidade">Naturalidade</label>
            <input id="naturalidade" name="naturalidade" type="text"/>
        </fieldset>
        <fieldset>
            <legend>Documentação</legend>
            <label for="rg">RG</label>
            <input id="rg" name="rg" type="text"/>
            <label for="rg_uf">UF</label>
            <input id="rg_uf" name="rg_uf" type="text"/>
            <label for="rg_emissao">Data de Emissão do RG</label>
            <input id="rg_emissao" name="rg_emissao" type="date"/>
            <label for="cpf">CPF*</label>
            <input id="cpf" name="cpf" type="text" required/>
            <label for="ctps">CTPS</label>
            <input id="ctps" name="ctps" type="text"/>
            <label for="ctps_emissao">Data de Emissão da CTPS</label>
            <input id="ctps_emissao" name="ctps_emissao" type="date"/>
            <label for="ctps_serie">Série da CTPS</label>
            <input id="ctps_serie" name="ctps_serie" type="text"/>
            <label for="pis">PIS</label>
            <input id="pis" name="pis" type="text"/>
            <label for="pis_emissao">Data de Emissão do PIS</label>
            <input id="pis_emissao" name="pis_emissao" type="date"/>
            <label for="titulo_eleitor">Título de Eleitor</label>
            <input id="titulo_eleitor" name="titulo_eleitor" type="text"/>
            <label for="zona_secao">Zona/Seção</label>
            <input id="zona_secao" name="zona_secao" type="text"/>
        </fieldset>
        <fieldset>
            <legend>Endereço</legend>
            <label for="endereco">Endereço</label>
            <input id="endereco" name="endereco" type="text"/>
            <label for="complemento">Complemento</label>
            <input id="complemento" name="complemento" type="text"/>
            <label for="cep">CEP</label>
            <input id="cep" name="cep" type="text"/>
            <label for="cidade_estado">Cidade/Estado</label>
            <input id="cidade_estado" name="cidade_estado" type="text"/>
        </fieldset>
        <fieldset>
            <legend>Dependentes</legend>
            <label for="possui_dependentes">Possui Dependentes?</label>
            <select id="possui_dependentes" name="possui_dependentes">
                <option value="nao" selected>Não</option>
                <option value="sim">Sim</option>
            </select>
            <div id="dependentes_campos">
                <label class="dependente-campo">Dependente 1 - Nome</label><input class="dependente-campo" name="Dependente 1 - Nome" type="text"/>
                <label class="dependente-campo">Dependente 1 - Nascimento</label><input class="dependente-campo" name="Dependente 1 - Nascimento" type="date"/>
                <label class="dependente-campo">Dependente 1 - Parentesco</label><input class="dependente-campo" name="Dependente 1 - Parentesco" type="text"/>
                <label class="dependente-campo">Dependente 2 - Nome</label><input class="dependente-campo" name="Dependente 2 - Nome" type="text"/>
                <label class="dependente-campo">Dependente 2 - Nascimento</label><input class="dependente-campo" name="Dependente 2 - Nascimento" type="date"/>
                <label class="dependente-campo">Dependente 2 - Parentesco</label><input class="dependente-campo" name="Dependente 2 - Parentesco" type="text"/>
                <label class="dependente-campo">Dependente 3 - Nome</label><input class="dependente-campo" name="Dependente 3 - Nome" type="text"/>
                <label class="dependente-campo">Dependente 3 - Nascimento</label><input class="dependente-campo" name="Dependente 3 - Nascimento" type="date"/>
                <label class="dependente-campo">Dependente 3 - Parentesco</label><input class="dependente-campo" name="Dependente 3 - Parentesco" type="text"/>
                <label class="dependente-campo">Dependente 4 - Nome</label><input class="dependente-campo" name="Dependente 4 - Nome" type="text"/>
                <label class="dependente-campo">Dependente 4 - Nascimento</label><input class="dependente-campo" name="Dependente 4 - Nascimento" type="date"/>
                <label class="dependente-campo">Dependente 4 - Parentesco</label><input class="dependente-campo" name="Dependente 4 - Parentesco" type="text"/>
            </div>
        </fieldset>
        <fieldset>
            <legend>Salário Família</legend>
            <label for="salario_familia">Possui direito?</label>
            <select id="salario_familia" name="salario_familia">
                <option value="Sim">Sim</option>
                <option selected="selected" value="Não">Não</option>
            </select>
        </fieldset>
        <fieldset>
            <legend>Contato</legend>
            <label for="email">E-mail</label>
            <input id="email" name="email" type="email"/>
            <label for="pix">PIX</label>
            <input id="pix" name="pix" type="text"/>
            <label for="telefone">Telefone</label>
            <input id="telefone" name="telefone" type="tel"/>
        </fieldset>
      <fieldset>
        <legend>Responsável pelo Cadastro</legend>
        <label for="data_responsavel">Data e Hora</label>
        <input id="data_responsavel" name="Data" readonly type="text"/>
        <label for="responsavel">Nome do Responsável*</label>
        <input id="responsavel" name="Nome do Responsável" required type="text"/>
      </fieldset>

      <div id="mensagem">Dados salvos com sucesso!</div>
      <div class="botoes-final">
        <button id="botao-imprimir" onclick="window.print();" type="button" style="display:none;">Imprimir Formulário</button>
        <button id="botao-enviar" type="submit">Salvar Dados</button>
      </div>
    </form>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      document.getElementById("data_responsavel").value = new Date().toLocaleString("pt-BR");

      const form = document.querySelector("form");
      const mensagem = document.getElementById("mensagem");
      const imprimir = document.getElementById("botao-imprimir");

      form.addEventListener("submit", function (event) {
        event.preventDefault();
        const dados = new FormData(form);

        fetch(form.action, {
          method: "POST",
          body: dados,
        }).then(response => {
          if (response.ok) {
            mensagem.style.display = "block";
            imprimir.style.display = "inline-block";
            form.querySelectorAll("input, textarea, select").forEach(el => el.disabled = true);
          }
        }).catch(() => alert("Erro ao enviar os dados."));
      });

      const selectDependentes = document.getElementById("possui_dependentes");
      const campos = document.querySelectorAll(".dependente-campo");
      selectDependentes.addEventListener("change", () => {
        campos.forEach(campo => {
          campo.style.display = selectDependentes.value === "sim" ? "block" : "none";
        });
      });
    });
  </script>
</body>
</html>
